<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dumb Quotes Billboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; color: white; margin-bottom: 40px; }
        h1 { font-size: 3em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .tagline { font-size: 1.2em; opacity: 0.9; }
        nav { display:flex; justify-content:center; gap:15px; margin-bottom:30px; }
        .nav-btn {
            background: white; color: #667eea; border: none; padding: 12px 30px;
            border-radius: 25px; cursor: pointer; font-size: 1em; font-weight: bold;
            transition: all 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .nav-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.2); }
        .nav-btn.active { background: #764ba2; color: white; }
        .page { display: none; animation: fadeIn 0.5s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .billboard {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px; padding: 30px; margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); color: white;
        }
        .billboard h2 { font-size: 2em; margin-bottom: 20px; text-align:center; }
        .billboard-quote {
            background: rgba(255,255,255,0.2); padding: 25px; border-radius: 15px;
            font-size: 1.3em; font-style: italic; text-align:center; margin-bottom: 15px;
        }
        .billboard-author { text-align: right; font-size: 1.1em; margin-top: 10px; }
        .billboard-votes { text-align:center; font-size:1em; margin-top:10px; opacity:0.95; }

        .add-quote-form, .login-page {
            background: white; border-radius: 20px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); margin-bottom: 30px; max-width: 500px;
            margin: 0 auto 30px auto;
        }
        .login-page { text-align:center; padding: 40px 30px; }
        .login-page h2 { color: #764ba2; margin-bottom: 20px; }

        .form-group { margin-bottom: 20px; text-align: left; }
        label { display:block; color:#667eea; font-weight:bold; margin-bottom:8px; }
        input, textarea {
            width:100%; padding:12px; border:2px solid #e0e0e0; border-radius:10px; font-size:1em;
            transition: border 0.3s;
        }
        input:focus, textarea:focus { outline:none; border-color:#667eea; }
        textarea { resize: vertical; min-height: 100px; }

        .submit-btn, .login-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; padding: 15px 40px; border-radius: 25px; cursor: pointer;
            font-size: 1.1em; font-weight: bold; width: 100%; transition: transform 0.3s;
        }
        .submit-btn:hover, .login-btn:hover { transform: scale(1.05); }

        .quotes-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap:20px;
        }
        .quote-card {
            background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .quote-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .vote-btn, .delete-btn { background:#f093fb; color:white; border:none; padding:8px 15px; border-radius:20px;
            cursor:pointer; font-size:0.9em; transition: background 0.3s; }
        .vote-btn[disabled] { opacity: 0.55; cursor: not-allowed; transform: none; }
        .delete-btn { background: #e74c3c; margin-left: auto; }
        .vote-btn:hover:not([disabled]) { background:#f5576c; }
        .delete-btn:hover { background:#c0392b; }
        .empty-state { text-align:center; color:white; font-size:1.2em; padding:60px 20px; background: rgba(255,255,255,0.1); border-radius:20px; }
        .user-status { text-align:right; margin-bottom:10px; color:white; font-weight:bold; }
    </style>
</head>
<body onload="initApp();">
    <div class="container">
        <header>
            <div id="userStatus" class="user-status"></div>
            <h1>üé≠ Dumb Quotes Billboard üé≠</h1>
            <p class="tagline">Celebrating humanity's finest moments of brilliance... NOT!</p>
        </header>

        <nav>
            <button class="nav-btn active" onclick="showPage('home')">Home</button>
            <button class="nav-btn" onclick="showPage('add')">Add Quote</button>
            <button class="nav-btn" onclick="showPage('all')">View All</button>
        </nav>

        <div id="home" class="page active">
            <div class="billboard">
                <h2>üèÜ Dumbest of the Week üèÜ</h2>
                <div id="weekBillboard"></div>
            </div>

            <div class="billboard">
                <h2>üëë Dumbest of All Time üëë</h2>
                <div id="allTimeBillboard"></div>
            </div>

            <h2 style="color: white; margin: 40px 0 20px 0; text-align: center;">All Dumb Quotes</h2>
            <div id="homeQuotes" class="quotes-grid"></div>
        </div>

        <div id="add" class="page">
            <div id="addContent"></div>
        </div>

        <div id="all" class="page">
            <h2 style="color: white; margin-bottom: 20px; text-align: center;">All Dumb Quotes</h2>
            <div id="allQuotes" class="quotes-grid"></div>
        </div>
    </div>

    <script>
        // =========================
        //  APP STATE + STORAGE
        // =========================

        let quotes = [];
        let accounts = []; // [{username:"x",password:"y"}]
        let userVotes = {}; // { username: [quoteIds] }
        let loggedInUser = null;

        function loadStorage() {
            quotes = JSON.parse(localStorage.getItem("dumbQuotes") || "[]");
            accounts = JSON.parse(localStorage.getItem("accounts") || "[]");
            userVotes = JSON.parse(localStorage.getItem("userVotes") || "{}");
            loggedInUser = localStorage.getItem("loggedInUser") || null;
        }

        function saveStorage() {
            localStorage.setItem("dumbQuotes", JSON.stringify(quotes));
            localStorage.setItem("accounts", JSON.stringify(accounts));
            localStorage.setItem("userVotes", JSON.stringify(userVotes));

            if (loggedInUser)
                localStorage.setItem("loggedInUser", loggedInUser);
            else
                localStorage.removeItem("loggedInUser");
        }

        function initApp() {
            loadStorage();
            updateLoginStatus();
            updateAllDisplays();
        }

        // =========================
        //      PASSWORD HASH
        // =========================

        // simple safe local hash for browser projects (Base64)
        function hashPassword(str) {
            return btoa(str); 
        }

        // =========================
        //      LOGIN STATUS BAR
        // =========================

        function updateLoginStatus() {
            const bar = document.getElementById("userStatus");

            if (loggedInUser) {
                bar.innerHTML = `Logged in as <b>${escapeHtml(loggedInUser)}</b> 
                    <button onclick="logout()" style="background:#e74c3c;color:white;border:none;padding:5px 10px;border-radius:8px;cursor:pointer;margin-left:10px;">Logout</button>`;
            } else {
                bar.innerHTML = `<span style="opacity:0.9;">Not Logged In</span>`;
            }

            updateAddPage();
            updateAllQuotes();
        }

        function logout() {
            loggedInUser = null;
            saveStorage();
            updateLoginStatus();
            showPage("home");
        }

        // =========================
        //      SHOW PAGES
        // =========================

        function showPage(name) {
            document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
            document.querySelectorAll(".nav-btn").forEach(b => b.classList.remove("active"));

            document.getElementById(name).classList.add("active");

            const btn = document.querySelector(`.nav-btn[onclick="showPage('${name}')"]`);
            if (btn) btn.classList.add("active");

            if (name === "add") updateAddPage();
        }

        // =========================
        //      REGISTER + LOGIN
        // =========================

        function updateAddPage() {
            const div = document.getElementById("addContent");

            if (!loggedInUser) {
                div.innerHTML = `
                    <div class="login-page">
                        <h2>Login / Create Account</h2>
                        <form onsubmit="event.preventDefault(); registerOrLogin();">
                            <div class="form-group">
                                <label>Username:</label>
                                <input id="loginUsername" type="text" required placeholder="Choose a username">
                            </div>
                            <div class="form-group">
                                <label>Password:</label>
                                <input id="loginPassword" type="password" required placeholder="Enter a password">
                            </div>
                            <button class="login-btn" type="submit">Continue</button>
                            <p style="font-size:0.9em;margin-top:10px;color:#555;">
                                *Accounts stored safely in your browser*
                            </p>
                        </form>
                    </div>
                `;
                return;
            }

            // if logged in
            div.innerHTML = `
                <div class="add-quote-form">
                    <h2 style="color:#667eea;margin-bottom:20px;">Submit a Dumb Quote</h2>
                    <form onsubmit="addQuote(event)">
                        <div class="form-group">
                            <label>Quote:</label>
                            <textarea id="quoteText" required placeholder="Enter the dumb quote..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Author:</label>
                            <input id="quoteAuthor" type="text" placeholder="Who said it?">
                        </div>
                        <button class="submit-btn" type="submit">Add Quote</button>
                    </form>
                </div>
            `;
        }

        function registerOrLogin() {
            const username = document.getElementById("loginUsername").value.trim();
            const password = document.getElementById("loginPassword").value.trim();

            if (!username || !password) {
                alert("Please fill all fields.");
                return;
            }

            const hashed = hashPassword(password);
            let account = accounts.find(acc => acc.username === username);

            if (!account) {
                // Create new account
                accounts.push({ username, password: hashed });
                loggedInUser = username;
                alert("Account created! Logged in.");
            } else {
                // Login attempt
                if (account.password !== hashed) {
                    alert("Incorrect password ‚ùå");
                    return;
                }
                loggedInUser = username;
                alert("Logged in successfully ‚úîÔ∏è");
            }

            saveStorage();
            updateLoginStatus();
            showPage("home");
        }

        // =========================
        //        ADD QUOTE
        // =========================

        function addQuote(e) {
            e.preventDefault();

            if (!loggedInUser) {
                alert("You must be logged in to add a quote.");
                return;
            }

            const text = document.getElementById("quoteText").value.trim();
            const author = document.getElementById("quoteAuthor").value.trim() || "Unknown";

            if (!text) {
                alert("Quote cannot be empty.");
                return;
            }

            quotes.push({
                id: Date.now(),
                text,
                author,
                votes: 0,
                date: new Date().toISOString(),
                submitter: loggedInUser
            });

            saveStorage();
            updateAllDisplays();

            alert("Quote added successfully!");
            showPage("all");
        }

        // =========================
        //        DELETE QUOTE
        // =========================

        function deleteQuote(id) {
            const i = quotes.findIndex(q => q.id === id);
            if (i === -1) return;

            if (quotes[i].submitter !== loggedInUser) {
                alert("You can only delete your own quotes.");
                return;
            }

            if (!confirm("Delete this quote?")) return;

            quotes.splice(i, 1);

            // remove from user votes too
            Object.keys(userVotes).forEach(u => {
                if (userVotes[u]) {
                    userVotes[u] = userVotes[u].filter(qid => qid !== id);
                }
            });

            saveStorage();
            updateAllDisplays();
        }

        // =========================
        //          VOTING
        // =========================

        function handleVoteClick(id) {
            if (!loggedInUser) {
                alert("You must be logged in to vote.");
                showPage("add");
                return;
            }
            voteQuote(id);
        }

        function voteQuote(id) {
            if (!userVotes[loggedInUser]) userVotes[loggedInUser] = [];

            if (userVotes[loggedInUser].includes(id)) {
                alert("You already voted for this quote ü§¶");
                return;
            }

            const quote = quotes.find(q => q.id === id);
            if (!quote) return;

            quote.votes++;
            userVotes[loggedInUser].push(id);

            saveStorage();
            updateAllDisplays();
        }

        // =========================
        //        BILLBOARDS
        // =========================

        function updateBillboards() {
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);

            const weekQuotes = quotes.filter(q => new Date(q.date) >= weekAgo);
            const weekWinner = weekQuotes.sort((a,b) => b.votes - a.votes)[0];
            const allTimeWinner = [...quotes].sort((a,b) => b.votes - a.votes)[0];

            document.getElementById("weekBillboard").innerHTML = weekWinner ?
                `
                <div class="billboard-quote">"${escapeHtml(weekWinner.text)}"</div>
                <div style="text-align:right;">‚Äî ${escapeHtml(weekWinner.author)}</div>
                <div style="text-align:center;">üî• ${weekWinner.votes} dump clicks</div>
                `
                :
                `<div class="billboard-quote">No quotes this week yet!</div>`;

            document.getElementById("allTimeBillboard").innerHTML = allTimeWinner ?
                `
                <div class="billboard-quote">"${escapeHtml(allTimeWinner.text)}"</div>
                <div style="text-align:right;">‚Äî ${escapeHtml(allTimeWinner.author)}</div>
                <div style="text-align:center;">üî• ${allTimeWinner.votes} dump clicks</div>
                `
                :
                `<div class="billboard-quote">No quotes yet!</div>`;
        }

        // =========================
        //        QUOTE LISTS
        // =========================

        function updateAllDisplays() {
            updateBillboards();
            updateAllQuotes();
        }

        function updateAllQuotes() {
            const sorted = [...quotes].sort((a,b) => b.votes - a.votes);

            const html = sorted.map(q => {
                const isSubmitter = loggedInUser === q.submitter;
                const hasVoted = loggedInUser &&
                                 userVotes[loggedInUser] &&
                                 userVotes[loggedInUser].includes(q.id);

                return `
                    <div class="quote-card">
                        <div style="font-style:italic;font-size:1.1em;">"${escapeHtml(q.text)}"</div>
                        <div style="color:#667eea;font-weight:bold;margin:8px 0;">
                            ‚Äî ${escapeHtml(q.author)}
                        </div>

                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            
                            <div>
                                <button 
                                    class="vote-btn"
                                    ${hasVoted ? "disabled" : ""}
                                    onclick="handleVoteClick(${q.id})">
                                    ${hasVoted ? "Voted ‚úì" : "Vote as Dumb ü§¶"}
                                </button>
                                <span style="font-weight:bold;color:#764ba2; margin-left:10px;">
                                    ${q.votes} dump clicks
                                </span>
                            </div>

                            ${isSubmitter 
                                ? `<button class="delete-btn" onclick="deleteQuote(${q.id})">Delete üóëÔ∏è</button>`
                                : ""}
                        </div>

                        <div style="margin-top:10px;font-size:0.9em;color:#777;">
                            Submitted by: ${escapeHtml(q.submitter)}
                        </div>
                    </div>
                `;
            }).join("");

            const emptyState = `<div style="color:white;text-align:center;">No quotes yet!</div>`;

            const homeContainer = document.getElementById("homeQuotes");
            const allContainer = document.getElementById("allQuotes");

            if(homeContainer) homeContainer.innerHTML = quotes.length ? html : emptyState;
            if(allContainer) allContainer.innerHTML = quotes.length ? html : emptyState;
        }

        // =========================
        //          HELPERS
        // =========================

        function escapeHtml(str) {
            if (typeof str !== 'string') return str;
            return str.replace(/[&<>"']/g, m => ({
                "&": "&amp;", "<": "&lt;", ">": "&gt;",
                '"': "&quot;", "'": "&#039;"
            }[m]));
        }
    </script>
</body>
</html>
